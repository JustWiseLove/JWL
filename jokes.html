<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>JOKES News & Weather</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Audiowide&display=swap" rel="stylesheet" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: Arial, Helvetica, sans-serif;
      background-color: #f0f2f0;
      color: #333;
      line-height: 1.6;
    }

    header {
      background: linear-gradient(90deg, #2a6626, #6b9e31, #2a6626);
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .logo {
      flex: 1;
      text-align: center;
    }

    .logo h1 {
      font-family: 'Audiowide', Arial, sans-serif;
      color: #fff;
      font-size: 48px;
      margin: 0;
    }

    .hamburger-left, .hamburger-right {
      display: block;
      cursor: pointer;
      padding: 5px;
      background: none;
      border: none;
      outline: none;
    }

    .hamburger-left span, .hamburger-right span {
      display: block;
      width: 25px;
      height: 3px;
      background: #fff;
      margin: 5px 0;
      transition: transform 0.3s ease, opacity 0.3s ease;
    }

    .hamburger-left.active span:nth-child(1), .hamburger-right.active span:nth-child(1) {
      transform: rotate(45deg) translate(5px, 5px);
    }

    .hamburger-left.active span:nth-child(2), .hamburger-right.active span:nth-child(2) {
      opacity: 0;
    }

    .hamburger-left.active span:nth-child(3), .hamburger-right.active span:nth-child(3) {
      transform: rotate(-45deg) translate(7px, -7px);
    }

    .nav-menu-left, .nav-menu-right {
      display: none;
      position: absolute;
      top: 80px;
      width: 200px;
      border-radius: 5px;
    }

    .nav-menu-left {
      left: 20px;
      background: linear-gradient(90deg, #2a6626, #6b9e31);
    }

    .nav-menu-right {
      right: 20px;
      background: linear-gradient(90deg, #6b9e31, #2a6626);
      text-align: right;
    }

    .nav-menu-left.active, .nav-menu-right.active {
      display: block;
    }

    .nav-menu-left li, .nav-menu-right li {
      list-style: none;
      padding: 15px 20px;
    }

    .nav-menu-left li a, .nav-menu-right li a {
      color: #fff;
      text-decoration: none;
      font-family: 'Audiowide', Arial, sans-serif;
      font-size: 16px;
      transition: color 0.3s;
    }

    .nav-menu-left li a:hover, .nav-menu-right li a:hover {
      color: #d4af37;
    }

    main {
      max-width: 100%;
      margin: 0;
      padding: 0;
    }

    .intro {
      background: linear-gradient(90deg, #f0f0f0, #d3d3d3);
      padding: 20px 0;
      margin-bottom: 30px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      width: 100%;
    }

    .intro-content {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
      text-align: center;
    }

    .intro h2 {
      font-family: 'Audiowide', Arial, sans-serif;
      color: #2a6626;
      margin-bottom: 10px;
    }

    .item {
      margin-bottom: 20px;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }

    .item-content {
      padding: 20px;
      background: linear-gradient(90deg, #f0f0f0, #d3d3d3);
      border-radius: 5px;
      text-align: center;
      color: #333;
    }

    .item-content p {
      color: #333;
    }

    .item-content h2 {
      margin-top: 40px;
      margin-bottom: 15px;
      font-family: 'Audiowide', Arial, sans-serif;
      color: #2a6626 !important;
      font-size: 1.5em;
      text-transform: uppercase;
    }

    .item-content h2:first-of-type {
      margin-top: 20px;
    }

    .item-content h3 {
      margin-top: 40px;
      margin-bottom: 15px;
      font-family: 'Audiowide', Arial, sans-serif;
      color: #2a6626;
      font-size: 1.5em;
      text-transform: uppercase;
    }

    .item-content h3:first-of-type {
      margin-top: 20px;
    }

    .scripture {
      background: linear-gradient(90deg, #2a6626, #6b9e31, #2a6626);
      padding: 15px;
      margin: 10px auto;
      border-radius: 8px;
      font-style: italic;
      color: #fff;
      max-width: 800px;
      text-align: center;
    }

    .item-content .scripture {
      color: #fff;
    }

    .describe {
      background: linear-gradient(90deg, #f0f0f0, #d3d3d3);
      padding: 15px;
      margin: 10px auto;
      border-radius: 8px;
      font-style: italic;
      color: #333;
      max-width: 800px;
      text-align: left;
    }

    .news-section .item-content h3 {
      margin-top: 0;
    }

    .news-section img {
      max-width: 100%;
      height: auto;
      border-radius: 5px;
      margin-bottom: 15px;
      object-fit: cover;
    }

    .news-section a {
      color: #6b9e31;
      text-decoration: none;
      font-weight: bold;
      display: inline-block;
      margin-top: 10px;
    }

    .news-section a:hover {
      text-decoration: underline;
    }

    .weather-box {
      padding: 20px;
      border-radius: 5px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    .weather-hourly,
    .weather-daily {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: center;
    }

    .hour,
    .day {
      flex: 1 1 150px;
      background: linear-gradient(90deg, #2a6626, #6b9e31);
      color: #fff;
      border-radius: 6px;
      padding: 10px;
      text-align: center;
      min-width: 120px;
    }

    .weather-icon {
      font-size: 30px;
      margin-bottom: 8px;
      color: #fff;
    }

    .error-message {
      color: #d32f2f;
      font-weight: bold;
      text-align: center;
      margin: 10px 0;
    }

    footer {
      background: linear-gradient(90deg, #2a6626, #6b9e31);
      text-align: center;
      padding: 20px;
      color: #fff;
      box-shadow: 0 -4px 6px rgba(0, 0, 0, 0.1);
      width: 100%;
    }

    footer p {
      margin: 10px 0 0;
    }

    @media (max-width: 768px) {
      .logo h1 {
        font-size: 42px;
      }

      .hour, .day {
        flex: 1 1 100px;
      }
    }
  </style>
</head>
<body>

<header>
  <button class="hamburger-left">
    <span></span>
    <span></span>
    <span></span>
  </button>
  <div class="logo">
    <h1>JOKES</h1>
  </div>
  <button class="hamburger-right">
    <span></span>
    <span></span>
    <span></span>
  </button>
  <ul class="nav-menu-left">
    <li><a href="#">Home</a></li>
    <li><a href="#">News</a></li>
    <li><a href="#">Weather</a></li>
  </ul>
  <ul class="nav-menu-right">
    <li><a href="#">About</a></li>
    <li><a href="#">Contact</a></li>
    <li><a href="#">Settings</a></li>
  </ul>
</header>

<main>
  <section class="intro">
    <div class="intro-content">
      <h2>Welcome to JOKES News & Weather</h2>
      <p class="describe">Stay updated with live BBC News directly from the source and real-time weather forecasts for North East, MD, including temperature, precipitation, wind, and humidity.</p>
    </div>
  </section>

  <section id="news" class="news-section">
    <div class="item">
      <div class="item-content">
        <h2>BBC News - Live Updates</h2>
        <div id="bbc-news"></div>
      </div>
    </div>
  </section>

  <section id="weather" class="weather-section">
    <div class="item">
      <div class="item-content weather-box">
        <h2>North East, MD Weather (EST, °F)</h2>
        <div class="scripture">Hourly Forecast (Next 12 Hours)</div>
        <div class="weather-hourly"></div>
        <div class="scripture">11-Day Forecast</div>
        <div class="weather-daily"></div>
      </div>
    </div>
  </section>
</main>

<footer>
  <p>© 2025 JOKES News & Weather</p>
</footer>

<script>
// Hamburger menu toggle
document.querySelector('.hamburger-left').addEventListener('click', function() {
  this.classList.toggle('active');
  document.querySelector('.nav-menu-left').classList.toggle('active');
});

document.querySelector('.hamburger-right').addEventListener('click', function() {
  this.classList.toggle('active');
  document.querySelector('.nav-menu-right').classList.toggle('active');
});

// News feed setup
const bbcFeedUrl = "https://feeds.bbci.co.uk/news/rss.xml";
const newsContainer = document.getElementById("bbc-news");

function cleanDescription(html) {
  // Remove HTML tags and normalize whitespace, preserving full text
  const div = document.createElement("div");
  div.innerHTML = html;
  let text = div.textContent || div.innerText || "";
  return text.replace(/\s+/g, " ").trim();
}

async function fetchNews() {
  try {
    const res = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(bbcFeedUrl)}`);
    if (!res.ok) throw new Error(`Failed to fetch news: ${res.status} ${res.statusText}`);
    const data = await res.json();
    data.items.slice(0, 10).forEach(item => {
      const articleDiv = document.createElement("div");
      articleDiv.className = "item";
      const fullDesc = cleanDescription(item.description); // Use full description without modification
      articleDiv.innerHTML = `
        <div class="item-content">
          <h3>${item.title}</h3>
          ${item.thumbnail ? `<img src="${item.thumbnail}" alt="BBC News image">` : 
            (item.description.match(/<img[^>]+src="([^">]+)"/)?.[1] ? 
              `<img src="${item.description.match(/<img[^>]+src="([^">]+)"/)[1]}" alt="BBC News image">` : '')}
          <p class="describe">${fullDesc}</p>
          <a href="${item.link}" target="_blank" rel="noopener noreferrer">Read more</a>
        </div>
      `;
      newsContainer.appendChild(articleDiv);
    });
  } catch (err) {
    newsContainer.innerHTML = `<p class="error-message">Failed to load BBC News feed: ${err.message}</p>`;
    console.error("Error loading BBC feed:", err);
  }
}

// Weather setup
const lat = 39.60; // North East, MD
const lon = -75.94; // North East, MD
const timezone = "America/New_York";

const weatherIcons = {
  0: "fa-sun", 1: "fa-sun", 2: "fa-cloud-sun", 3: "fa-cloud", 45: "fa-smog", 48: "fa-smog",
  51: "fa-cloud-rain", 53: "fa-cloud-rain", 55: "fa-cloud-showers-heavy", 61: "fa-cloud-showers-heavy",
  63: "fa-cloud-showers-heavy", 65: "fa-cloud-showers-heavy", 71: "fa-snowflake", 73: "fa-snowflake",
  75: "fa-snowflake", 80: "fa-cloud-showers-heavy", 81: "fa-cloud-showers-heavy", 82: "fa-cloud-showers-heavy",
  95: "fa-bolt", 99: "fa-bolt"
};

function cToF(c) {
  return Math.round(c * 9/5 + 32);
}

function msToMph(ms) {
  return Math.round(ms * 2.237);
}

function getIcon(code) {
  return weatherIcons[code] || "fa-question";
}

function showHourly(hourly) {
  const container = document.querySelector(".weather-hourly");
  container.innerHTML = "";
  const now = new Date();
  const startIndex = hourly.time.findIndex(t => {
    const dt = new Date(t);
    return (
      dt.getFullYear() === now.getFullYear() &&
      dt.getMonth() === now.getMonth() &&
      dt.getDate() === now.getDate() &&
      dt.getHours() >= now.getHours()
    );
  });
  if (startIndex === -1) {
    container.innerHTML = "<p class='error-message'>No hourly data available for current time.</p>";
    return;
  }

  for (let i = startIndex; i < startIndex + 12 && i < hourly.time.length; i++) {
    const dt = new Date(hourly.time[i]);
    const hourStr = dt.toLocaleTimeString("en-US", { hour: "numeric", hour12: true, timeZone: timezone });
    const tempF = cToF(hourly.temperature_2m[i]);
    const code = hourly.weathercode[i];
    const iconClass = getIcon(code);
    const precip = hourly.precipitation_probability[i];
    const wind = msToMph(hourly.windspeed_10m[i]);
    const humidity = hourly.relativehumidity_2m[i];

    const div = document.createElement("div");
    div.className = "hour";
    div.innerHTML = `
      <i class="fas ${iconClass} weather-icon"></i>
      <strong>${hourStr}</strong><br/>
      ${tempF}°F<br/>
      Precip: ${precip}%<br/>
      Wind: ${wind} mph<br/>
      Humidity: ${humidity}%
    `;
    container.appendChild(div);
  }
}

function showDaily(daily) {
  const container = document.querySelector(".weather-daily");
  container.innerHTML = "";
  const now = new Date();
  const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
  
  const startIndex = daily.time.findIndex(t => {
    const dt = new Date(t);
    return (
      dt.getFullYear() === today.getFullYear() &&
      dt.getMonth() === now.getMonth() &&
      dt.getDate() === now.getDate()
    );
  });

  if (startIndex === -1) {
    container.innerHTML = "<p class='error-message'>No forecast data available for current day.</p>";
    return;
  }

  for (let i = startIndex; i < startIndex + 11 && i < daily.time.length; i++) {
    const dt = new Date(daily.time[i]);
    const dayStr = dt.toLocaleDateString("en-US", { 
      weekday: "short", 
      month: "short", 
      day: "numeric", 
      timeZone: timezone 
    });
    const maxF = cToF(daily.temperature_2m_max[i]);
    const minF = cToF(daily.temperature_2m_min[i]);
    const code = daily.weathercode[i];
    const iconClass = getIcon(code);
    const precip = daily.precipitation_probability_max[i];
    const wind = msToMph(daily.windspeed_10m_max[i]);

    const div = document.createElement("div");
    div.className = "day";
    div.innerHTML = `
      <i class="fas ${iconClass} weather-icon"></i>
      <strong>${dayStr}</strong><br/>
      High: ${maxF}°F<br/>
      Low: ${minF}°F<br/>
      Precip: ${precip}%<br/>
      Wind: ${wind} mph
    `;
    container.appendChild(div);
  }
}

async function fetchWeather() {
  const weatherBox = document.querySelector(".weather-box");
  try {
    const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&hourly=temperature_2m,weathercode,precipitation_probability,windspeed_10m,relativehumidity_2m&daily=temperature_2m_max,temperature_2m_min,weathercode,precipitation_probability_max,windspeed_10m_max&forecast_days=11&current_weather=true&timezone=${encodeURIComponent(timezone)}`;
    const res = await fetch(url, { cache: "no-store" });
    if (!res.ok) throw new Error(`HTTP error: ${res.status} ${res.statusText}`);
    const data = await res.json();
    
    if (!data.hourly || !data.daily) {
      throw new Error("Incomplete weather data received");
    }

    showHourly(data.hourly);
    showDaily(data.daily);
  } catch (e) {
    weatherBox.innerHTML += `<p class="error-message">Weather data not available: ${e.message}. Please try again later.</p>`;
    console.error("Weather fetch error:", e);
  }
}

// Run both
fetchNews();
fetchWeather();
</script>

</body>
</html>
